{% set fsf_step = "package" %}
{% extends "first-snap/_layout_fsf.html" %}

{% block fsf_content %}
  <div class="row">
    <div class="col-8">
      <h4 class="p-list-step__title">
        Choose snap name
      </h4>
      <form id="choose-name-form">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
        <label>Please pick a snap name for the purpose of this tutorial:</label>
        <div class="p-form-validation">
          <input class="p-form-validation__input" type="text" name="snap-name" value="{{ snap_name }}" />
          <p class="p-form-validation__message" id="input-error-message-inline" role="alert">
            Name should only have lowercase letters, numbers, and hyphens, must have at least one letter, and cannot start or end with a hyphen.
          </p>
        </div>
        <button class="p-button--positive" disabled>Choose snap name</button>
      </form>
    </div>
  </div>

  <div class="row">
    <p>Now we'll take a real world app, and package it as a snap</p>
  </div>

  <div class="row">
    <div class="col-8">
      <ol class="p-list-step has-margin">
        <li class="p-list-step__item">
          <h4 class="p-list-step__title">
            <span class="p-list-step__bullet">1</span>
            Download a copy of the app
          </h4>
          {% set snippet_value = steps.download %}
          {% set snippet_id = "download" %}
          {% include "/partials/_code-snippet.html" %}
        </li>
        <li class="p-list-step__item">
          <h4 class="p-list-step__title">
            <span class="p-list-step__bullet">2</span>
            Open the snapcraft.yaml file in the root of the project
          </h4>
          {% set snippet_value = steps.createDir %}
          {% set snippet_id = "createdir" %}
          {% include "/partials/_code-snippet-multi.html" %}
        </li>
        <li class="p-list-step__item">
          <h4 class="p-list-step__title">
            <span class="p-list-step__bullet">3</span>
            The snapcraft.yaml file starts with a small amount of human-readable metadata.
          </h4>
          <div class="p-list-step__content">
            {% set snippet_value = steps.metadata %}
            {% set snippet_id = "metadata" %}
            {% include "/partials/_code.html" %}
            {% for item in steps.explain.metadata %}
              {% if item.text %}
                <p>{{ item.text|safe }}</p>
              {% elif item.code %}
                <pre><code>{{ item.code }}</code></pre>
              {% elif item.warning %}
                <div class="p-notification--caution">
                  <p class="p-notification__response">
                    {{ item.warning|replace("${name}", snap_name)|safe }}
                  </p>
                </div>
              {% endif %}
            {% endfor %}
          </div>
        </li>
        <li class="p-list-step__item">
          <h4 class="p-list-step__title">
            <span class="p-list-step__bullet">4</span>
            Security model
          </h4>
          <div class="p-list-step__content">
            {% for item in steps.explain.security %}
              {% if item.text %}
                <p>{{ item.text|safe }}</p>
              {% elif item.code %}
                <pre><code>{{ item.code }}</code></pre>
              {% elif item.warning %}
                <div class="p-notification--caution">
                  <p class="p-notification__response">
                    {{ item.warning|replace("${name}", snap_name)|safe }}
                  </p>
                </div>
              {% endif %}
            {% endfor %}
          </div>
        </li>
        {% if steps.explain.base %}
        <li class="p-list-step__item">
          <h4 class="p-list-step__title">
            <span class="p-list-step__bullet">5</span>
            Base
          </h4>
          <div class="p-list-step__content">
            {% for item in steps.explain.base %}
              {% if item.text %}
                <p>{{ item.text|safe }}</p>
              {% elif item.code %}
                <pre><code>{{ item.code }}</code></pre>
              {% elif item.warning %}
                <div class="p-notification--caution">
                  <p class="p-notification__response">
                    {{ item.warning|replace("${name}", snap_name)|safe }}
                  </p>
                </div>
              {% endif %}
            {% endfor %}
          </div>
        </li>
        {% endif %}
        <li class="p-list-step__item">
          <h4 class="p-list-step__title">
            <span class="p-list-step__bullet">6</span>
            Parts
          </h4>
          <div class="p-list-step__content">
            {% for item in steps.explain.parts %}
              {% if item.text %}
                <p>{{ item.text|safe }}</p>
              {% elif item.code %}
                <pre><code>{{ item.code }}</code></pre>
              {% elif item.warning %}
                <div class="p-notification--caution">
                  <p class="p-notification__response">
                    {{ item.warning|replace("${name}", snap_name)|safe }}
                  </p>
                </div>
              {% endif %}
            {% endfor %}
          </div>
        </li>
        <li class="p-list-step__item">
          <h4 class="p-list-step__title">
            <span class="p-list-step__bullet">7</span>
            Apps
          </h4>
          <div class="p-list-step__content">
            {% for item in steps.explain.apps %}
            {% if item.text %}
            <p>{{ item.text|safe }}</p>
            {% elif item.code %}
            <pre><code>{{ item.code }}</code></pre>
            {% elif item.warning %}
            <div class="p-notification--caution">
              <p class="p-notification__response">
                {{ item.warning|replace("${name}", snap_name)|safe }}
              </p>
            </div>
            {% endif %}
            {% endfor %}
          </div>
        </li>
      </ol>
    </div>
  </div>
{% endblock %}

{% block fsf_pagination %}
  <a class="p-pagination__link--previous" href="/first-snap/{{ language }}">
    <span class="p-pagination__label">Previous</span>
    <span class="p-pagination__title">Install Snapcraft</span>
  </a>
  <a class="p-pagination__link--next" href="/first-snap/{{ language }}/{{ os }}/build">
    <span class="p-pagination__label">Next</span>
    <span class="p-pagination__title">Build snap</span>
  </a>
{% endblock %}

{% block scripts %}
  <script src="{{ static_url('js/dist/public.js') }}"></script>
  <script>
    Raven.context(function() {
      snapcraft.public.firstSnapFlow.initChooseName(
        document.getElementById("choose-name-form")
      );
      // snapcraft.public.initAccordion('.p-accordion__list');
    });
  </script>
  {{ super() }}
{% endblock %}
