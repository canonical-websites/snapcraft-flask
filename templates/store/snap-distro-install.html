{% extends webapp_config['LAYOUT'] %}

{% block meta_copydoc %}{% endblock %}

{% block meta_title %}Install {{ snap_title }} on {{ distro_name }} using the Snap Store | Snapcraft{% endblock %}

{% block meta_description %}Get the latest version of {{ snap_title }} for on {{ distro_name }} - {{ summary }}{% endblock %}

{% if icon_url %}
  {% block meta_image %}
    {{ icon_url }}
  {% endblock %}
{% endif %}

{% block meta_schema %}
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "{{ snap_title }}",
      "description": "{{ summary }}",
      "datePublished": "{{ last_updated_raw }}",
      {% if screenhots and screenshots|length > 0 %}
      "screenshot": "{{ screenshots[0] }}",
      {% endif %}
      "image": "{{ icon_url }}",
      "operatingSystem": "linux",
      "offers": {
        "price": {% if prices and prices['USD'] %}{{ prices['USD'] }}{% else %}0.00{% endif %},
        "priceCurrency": "USD"
      },
      "author": {
        "@type": "Person",
        "name": "{{ publisher }}"
        {% if website %}, {# the , is within the if to avoid parsing errors #}
        "url": "{{ website }}"
        {% endif %}
      },
      "softwareVersion": "{{ version }}",
      "fileSize": "{{ filesize }}",
      "license": "{{ license }}"
    }
  </script>
{% endblock %}

{% block content %}
  <div class="p-strip--light is-shallow distro-background">
    <style>
      .distro-background {
        background-image: linear-gradient(-90deg, {{ distro_color_1 }}, {{ distro_color_2 }});
      }
    </style>
    <div class="row">
      <div class="col-8">
        <h1 class="p-heading--two" style="color: #f7f7f7">How to install {{ snap_title }}<br/> on <b>{{ distro_name }}</b></h1>
      </div>
      <div class="col-3">
        <img src="{{ distro_logo }}" />
      </div>
    </div>
  </div>
  <div class="p-strip is-shallow">
    <div class="row">
      <div class="p-snap-heading">
        {% if icon_url %}
          <img class="p-snap-heading__icon" src="{{ icon_url }}" alt="{{ snap_title }} snap" data-live="icon" />
        {% else %}
          <img class="p-snap-heading__icon" src="https://assets.ubuntu.com/v1/be6eb412-snapcraft-missing-icon.svg" alt="" data-live="icon" />
        {% endif %}
        <div class="p-snap-heading__title">
          <h1 class="p-heading--two p-snap-heading__name" data-live="title">{{ snap_title }}</h1>
          <div class="u-hide u-show--small">
            {% include 'store/_snap-header-information.html' %}
          </div>
          <ul class="p-inline-list--middot">
            <li class="p-inline-list__item u-hide--small">
              {% include 'store/_snap-header-information.html' %}
            </li>
            {% for category in categories %}<li class="p-inline-list__item">
              <a href="/search?category={{category.slug}}">{{ category.name }}</a>
            </li>{% endfor %}
          </ul>
        </div>

        <div class="p-snap-install-buttons">
          <a class="p-button--positive p-snap-install-buttons__install" href="#install">
            Install
          </a>
        </div>

      </div>
    </div>
  </div>

  {% if screenshots or videos %}
    <div class="p-strip--light is-shallow">
      <div class="row" id="js-snap-screenshots" data-live="screenshots">
        {% if videos %}
          {% include "partials/_snap-details-video-layout.html" %}
        {% elif screenshots %}
          {% include "partials/_snap-details-image-layout.html" %}
        {% endif %}
      </div>
    </div>
  {% endif %}

  <div class="p-strip is-shallow">
    <div class="row">
      <div class="col-8">
        {% if summary %}<h4 data-live="summary">{{ summary }}</h4>{% endif %}
        <div data-live="description">{{ description | safe }}</div>
      </div>
      <div class="col-4">
        <h4>Details for {{ snap_title }}</h4>
        <dl>
          <dt>License</dt>
          <dd data-live="license">{{ license }}</dd>
          <dt>Last updated</dt>
          <dd>{{ last_updated }}</dd>
        </dl>
      </div>
    </div>
  </div>

  {% if api_error %}
    <div class="row">
      <div class="col-12">
        <div class="p-notification--negative">
          <p class="p-notification__response">
            <span class="p-notification__status">Error:</span> API request failed
          </p>
        </div>
      </div>
    </div>
  {% endif %}

  <section class="p-strip is-shallow">
    <div class="row">
      <hr />
    </div>
  </section>

  <div id="install" class="p-strip is-shallow">
    <div class="row">
      <h2>Snap install instructions for {{ distro_name }}</h2>
    </div>
    <div class="row">
      <h3>Instructions to enable snapd support</h3>
    </div>
    {% for step in distro_install_steps %}
    <div class="row">
      <div class="col-7">
        <p>{{ step.action|safe }}</p>
      </div>
      {% if step.command %}
      <div class="col-5">
        {% set snippet_value = step.command %}
        {% set snippet_id = "distro-install-command-" + loop.index|string %}
        {% if step.command.count('\n') == 0 %}
          {% include "/partials/_code-snippet.html" %}
        {% else %}
          {% include "/partials/_code-snippet-multi.html" %}
        {% endif %}
      </div>
      {% endif %}
    </div>
    {% endfor %}
    <div class="row">
      <h3>How to install a snap</h3>
    </div>
    <div class="row">
      <div class="col-7">
        <p>To install a snap, simply use the following command:</p>
      </div>
      <div class="col-5">
        {% set snippet_value = "sudo snap install " + package_name %}
        {% set snippet_id =  "snap-install-stable" %}
        {% include "/partials/_code-snippet.html" %}
      </div>
    </div>
    <div class="row">
      <h3>Find more software in snapcraft.io</h3>
    </div>
    <div class="row">
      <div class="col-7">
        <p>Search for more snaps from the command line:</p>
      </div>
      <div class="col-5">
        {% set snippet_value = 'sudo snap find "search query"' %}
        {% set snippet_id =  "snap-search" %}
        {% include "/partials/_code-snippet.html" %}
      </div>
    </div>
  </div>


  <section class="p-strip is-shallow">
    <div class="row">
      <hr />
    </div>
  </section>

  <section class="p-strip is-shallow">
    <div class="row">
        <h2 class="u-float--left">Find more popular snaps</h2>
        <a href="/search?category=featured" class="p-button--neutral u-float--right u-hide--small p-featured-snap__see-more">See more...</a>
    </div>
    <div class="row">
      {% set snaps = featured_snaps %}
      {% set category = "featured" %}
      {% set show_summary = True %}
      {% include "store/_category-partial.html" %}
    </div>
    <div class="row u-hide--medium u-hide--large">
      <a href="/search?category=featured" class="p-button--neutral u-float--right">See more in Featured</a>
    </div>
  </section>


  <section class="p-strip--image is-deep is-dark p-strip--snap-store">
    <div class="row u-vertically-center">
      <div class="col-7 u-fade-left--medium">
        <p class="u-hide--large u-hide--medium u-align--center">
          <img src="https://assets.ubuntu.com/v1/08af835e-Snap+Store+shopping+icon.svg" alt="Get the Snap Store snap" class="p-icon--snap-store u-fade-up">
        </p>
        <h1 class="p-heading--two">Access the App Store for Linux <br class="u-hide--small u-hide--medium">from your desktop</h1>
        <p class="u-no-padding--top p-heading--four">Easily find and install new applications or remove existing installed applications with the Snap Store snap.</p>
        <p>
          <a href="/snap-store" class="p-button--positive">Get the Snap Store</a>
        </p>
      </div>
      <div class="col-4 u-hide--small prefix-1">
          <img src="https://assets.ubuntu.com/v1/08af835e-Snap+Store+shopping+icon.svg" alt="Get the Snap Store snap" class="p-icon--snap-store u-fade-up">
      </div>
    </div>
  </section>

  {# templates #}
  {% set video = {'type': 'youtube', 'url': '${url}', 'id': '${id}'} %}
  <script type="text/template" id="video-youtube-template">
    {% include 'partials/_video.html' %}
  </script>
  {% set video = {'type': 'vimeo', 'url': '${url}', 'id': '${id}'} %}
  <script type="text/template" id="video-vimeo-template">
    {% include 'partials/_video.html' %}
  </script>
  {% set video = {'type': 'asciinema', 'url': '${url}', 'id': '${id}'} %}
  <script type="text/template" id="video-asciinema-template">
    {% include 'partials/_video.html' %}
  </script>
{% endblock %}

{% block scripts_modules %}
  <script src="{{ static_url('js/modules/clipboard.min.js') }}"></script>
{% endblock %}

{% block scripts %}
  <script src="{{ static_url('js/dist/public.js') }}"></script>
  <script>
    Raven.context(function () {
      try {
        snapcraft.public.screenshots('#js-snap-screenshots');
      } catch(e) {
        Raven.captureException(e);
      }

      try {
        snapcraft.public.videos('.js-video-slide');
      } catch(e) {
        Raven.captureException(e);
      }

      if (typeof ClipboardJS !== 'undefined') {
        new ClipboardJS('.js-clipboard-copy');
      }
    });
  </script>
{% endblock %}
